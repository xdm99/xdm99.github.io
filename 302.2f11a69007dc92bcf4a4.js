"use strict";(self.webpackChunkrareworlds_app=self.webpackChunkrareworlds_app||[]).push([[302],{5302:(E,p,s)=>{s.r(p),s.d(p,{WorldsBrowserModule:()=>P});var u=s(8583),f=s(8555),d=s(4889),e=s(639),m=s(4839),g=s(8465),h=s(1495);function b(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){return e.CHM(t),e.oxw().loadFullData()}),e._uU(1," Load Full Data "),e.qZA()}}function v(r,n){if(1&r&&(e.ynx(0),e._UZ(1,"app-world-grid",5),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("worlds",t.worlds)}}function _(r,n){1&r&&e._uU(0," Loading...\n")}let F=(()=>{class r{constructor(t,o){this.worldsService=t,this.userService=o}ngOnInit(){this.worldsService.dataReady$.subscribe(t=>{t&&(this.worlds=Array.from(this.worldsService.worlds.values()))}),this.userService.currentUser$.subscribe(t=>this.user=t)}loadFullData(){}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.R),e.Y36(g.K))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-worlds-browser"]],decls:7,vars:3,consts:[[1,"worlds-browser-header"],["class","btn btn-outline",3,"click",4,"ngIf"],[4,"ngIf","ngIfElse"],["loading",""],[1,"btn","btn-outline",3,"click"],[3,"worlds"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"h3"),e._uU(2,"Worlds Browser"),e.qZA(),e.YNc(3,b,2,0,"button",1),e.qZA(),e.YNc(4,v,2,1,"ng-container",2),e.YNc(5,_,1,0,"ng-template",null,3,e.W1O)),2&t){const l=e.MAs(6);e.xp6(3),e.Q6J("ngIf",o.user&&o.user.isTester()),e.xp6(1),e.Q6J("ngIf",o.worlds)("ngIfElse",l)}},directives:[u.O5,h.l],styles:[".worlds-browser-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}"]}),r})();var C=s(690);const x=["filter",(0,s(2981).h)({outline:'<path d="M33,4H3A1,1,0,0,0,2,5V6.67a1.79,1.79,0,0,0,.53,1.27L14,19.58v10.2l2,.76V19a1,1,0,0,0-.29-.71L4,6.59V6H32v.61L20.33,18.29A1,1,0,0,0,20,19l0,13.21L22,33V19.5L33.47,8A1.81,1.81,0,0,0,34,6.7V5A1,1,0,0,0,33,4Z"/>',solid:'<path d="M22,33V19.5L33.47,8A1.81,1.81,0,0,0,34,6.7V5a1,1,0,0,0-1-1H3A1,1,0,0,0,2,5V6.67a1.79,1.79,0,0,0,.53,1.27L14,19.58v10.2Z"/><path d="M33.48,4h-31A.52.52,0,0,0,2,4.52V6.24a1.33,1.33,0,0,0,.39.95l12,12v10l7.25,3.61V19.17l12-12A1.35,1.35,0,0,0,34,6.26V4.52A.52.52,0,0,0,33.48,4Z"/>'})];var Z=s(5435),T=s(5257),w=s(4939),i=s(665),O=s(3791),a=s(1653),A=s(7519);let I=(()=>{class r{constructor(t){this.fb=t,this.valueChanged=new e.vpe,this.createForm()}ngOnInit(){this.filterForm.valueChanges.pipe((0,A.x)()).subscribe(({fromRarity:t,toRarity:o})=>{!this.onChange||this.onChange(Object.assign(this.value,{values:[{value:t||1,valueOperator:"gte"},{value:o||1e4,valueOperator:"lte"}]}))})}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){t?this.filterForm.disable():this.filterForm.disabled&&this.filterForm.enable()}writeValue(t){if(this.value=t,2===t.values.length){const[o,l]=t.values.map(c=>c.value);this.filterForm.setValue({fromRarity:o,toRarity:l})}else 0===t.values.length&&this.filterForm.setValue({fromRarity:"",toRarity:""})}createForm(){this.filterForm=this.fb.group({fromRarity:["",i.kI.compose([i.kI.min(1),i.kI.min(1e4)])],toRarity:["",i.kI.compose([i.kI.min(1),i.kI.min(1e4)])]})}checkKeydown(t){"Enter"===t.code&&t.preventDefault()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(i.qu))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-rarity-filter"]],outputs:{valueChanged:"valueChanged"},features:[e._Bn([{provide:i.JU,useExisting:r,multi:!0}])],decls:12,vars:1,consts:[[1,"rarity-container",3,"formGroup"],["for","minRarity"],["id","minRarity","formControlName","fromRarity","type","number","min","1","max","10000",1,"clr-input",3,"keydown"],["for","maxRarity"],["id","maxRarity","formControlName","toRarity","type","number","min","1","max","10000",1,"clr-input",3,"keydown"]],template:function(t,o){1&t&&(e.TgZ(0,"div"),e.TgZ(1,"strong"),e._uU(2,"Rarity"),e.qZA(),e.qZA(),e.TgZ(3,"div",0),e.TgZ(4,"div"),e.TgZ(5,"label",1),e._uU(6,"From"),e.qZA(),e.TgZ(7,"input",2),e.NdJ("keydown",function(c){return o.checkKeydown(c)}),e.qZA(),e.qZA(),e.TgZ(8,"div"),e.TgZ(9,"label",3),e._uU(10,"To"),e.qZA(),e.TgZ(11,"input",4),e.NdJ("keydown",function(c){return o.checkKeydown(c)}),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(3),e.Q6J("formGroup",o.filterForm))},directives:[i.JL,i.sg,a.MgK,i.Fj,i.wV,i.qQ,i.Fd,i.JJ,i.u],styles:["input[type=number][_ngcontent-%COMP%]{width:3.5rem}label[_ngcontent-%COMP%]{font-size:.6rem}.rarity-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;align-content:flex-start;width:10rem}"]}),r})();var J=s(7647);function V(r,n){if(1&r&&(e.ynx(0),e._UZ(1,"app-feature-chip",4),e.BQk()),2&r){const t=n.$implicit;e.xp6(1),e.Q6J("feature",t)("textOnly",!0)}}function B(r,n){if(1&r&&(e.TgZ(0,"clr-option",5),e._UZ(1,"app-feature-chip",6),e.qZA()),2&r){const t=n.$implicit;e.Q6J("clrValue",t),e.xp6(1),e.Q6J("feature",t)}}function M(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"clr-combobox-container"),e.TgZ(1,"clr-combobox",1),e.NdJ("ngModelChange",function(l){return e.CHM(t),e.oxw().selection=l})("clrSelectionChange",function(l){return e.CHM(t),e.oxw().selectionChange(l)}),e.YNc(2,V,2,2,"ng-container",2),e.TgZ(3,"clr-options"),e.YNc(4,B,2,2,"clr-option",3),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("clrMulti",!0)("ngModel",t.selection),e.xp6(3),e.Q6J("clrOptionItemsOf",t.features)("clrOptionItemsField","name")}}let W=(()=>{class r{constructor(t){this.worldsService=t,this.connectToData()}ngOnInit(){}writeValue(t){this.value=t,this.selection=t.values.map(o=>this.worldsService.features.get(o.value))}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}selectionChange({model:t}){this.selection=Array.isArray(t)?t:null===t?[]:[t],this.onChange&&this.onChange(Object.assign(this.value,{values:this.selection.map(o=>({value:o.idx,valueOperator:"eq"}))}))}connectToData(){this.worldsService.dataReady$.subscribe(()=>{this.features=Array.from(this.worldsService.features.values()).filter(t=>t.idx<1e3)})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.R))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-features-filter"]],features:[e._Bn([{provide:i.JU,useExisting:r,multi:!0}])],decls:4,vars:1,consts:[[4,"ngIf"],["placeholder","Feature name...","name","features",1,"filter-combobox",3,"clrMulti","ngModel","ngModelChange","clrSelectionChange"],[4,"clrOptionSelected"],[3,"clrValue",4,"clrOptionItems","clrOptionItemsOf","clrOptionItemsField"],[3,"feature","textOnly"],[3,"clrValue"],[3,"feature"]],template:function(t,o){1&t&&(e.TgZ(0,"div"),e.TgZ(1,"strong"),e._uU(2,"Features"),e.qZA(),e.qZA(),e.YNc(3,M,5,4,"clr-combobox-container",0)),2&t&&(e.xp6(3),e.Q6J("ngIf",o.features))},directives:[u.O5,a.c6t,a.HFh,i.JJ,i.On,a.Iql,a.yqN,a.vK$,J.v,a.DTD],styles:[""]}),r})();var R=s(4370);function U(r,n){if(1&r&&(e.ynx(0),e._UZ(1,"app-biome-chip",4),e.BQk()),2&r){const t=n.$implicit;e.xp6(1),e.Q6J("biome",t)}}function N(r,n){if(1&r&&(e.TgZ(0,"clr-option",5),e._UZ(1,"app-biome-chip",4),e.qZA()),2&r){const t=n.$implicit;e.Q6J("clrValue",t),e.xp6(1),e.Q6J("biome",t)}}function Q(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"clr-combobox-container"),e.TgZ(1,"clr-combobox",1),e.NdJ("ngModelChange",function(l){return e.CHM(t),e.oxw().selection=l})("clrSelectionChange",function(l){return e.CHM(t),e.oxw().selectionChange(l)}),e.YNc(2,U,2,1,"ng-container",2),e.TgZ(3,"clr-options"),e.YNc(4,N,2,2,"clr-option",3),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("clrMulti",!0)("ngModel",t.selection),e.xp6(3),e.Q6J("clrOptionItemsOf",t.biomes)("clrOptionItemsField","name")}}let S=(()=>{class r{constructor(t){this.worldsService=t,this.connectToData()}ngOnInit(){}writeValue(t){this.value=t,this.selection=t.values.map(o=>this.worldsService.biomes.get(o.value))}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}selectionChange({model:t}){this.selection=Array.isArray(t)?t:null===t?[]:[t],this.onChange&&this.onChange(Object.assign(this.value,{values:this.selection.map(o=>({value:o.idx,valueOperator:"eq"}))}))}connectToData(){this.worldsService.dataReady$.subscribe(()=>{this.biomes=Array.from(this.worldsService.biomes.values())})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.R))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-biomes-filter"]],features:[e._Bn([{provide:i.JU,useExisting:r,multi:!0}])],decls:4,vars:1,consts:[[4,"ngIf"],["placeholder","Biome name...","name","features",1,"filter-combobox",3,"clrMulti","ngModel","ngModelChange","clrSelectionChange"],[4,"clrOptionSelected"],[3,"clrValue",4,"clrOptionItems","clrOptionItemsOf","clrOptionItemsField"],[3,"biome"],[3,"clrValue"]],template:function(t,o){1&t&&(e.TgZ(0,"div"),e.TgZ(1,"strong"),e._uU(2,"Biomes"),e.qZA(),e.qZA(),e.YNc(3,Q,5,4,"clr-combobox-container",0)),2&t&&(e.xp6(3),e.Q6J("ngIf",o.biomes))},directives:[u.O5,a.c6t,a.HFh,i.JJ,i.On,a.Iql,a.yqN,a.vK$,R.Z,a.DTD],styles:[""]}),r})();var q=s(43),D=s(5187);let j=(()=>{class r{constructor(t,o,l,c){this.worldService=t,this.gridUrlParams=o,this.fb=l,this.appTheme=c,this.activeFilters=0,this.setItemDefaultValue={values:[],setOperator:"and"},this.initForm()}initForm(){this.filterForm=this.fb.group({features:this.fb.control(Object.assign({},this.setItemDefaultValue)),biomes:this.fb.control(Object.assign({},this.setItemDefaultValue)),rarity:this.fb.control(Object.assign({},this.setItemDefaultValue)),resources:this.fb.control(Object.assign({},this.setItemDefaultValue)),geography:this.fb.control(Object.assign({},this.setItemDefaultValue))}),this.filterForm.valueChanges.subscribe(t=>{this.activeFilters=Object.keys(t).reduce((o,l)=>o+(t[l].values.length>0?1:0),0)})}ngOnInit(){this.loadIcons(),this.initFilterWithExistingParams()}loadIcons(){C.Q.addIcons(x)}initFilterWithExistingParams(){this.worldService.dataReady$.pipe((0,Z.h)(t=>t),(0,T.q)(1)).subscribe(t=>this._initFilterWithParams())}getBadge(){return""}submitFilter(){this.filterForm.valid?(this.gridUrlParams.setParamsAndNavigate(this.filterForm.value),this.appTheme.setVerticalNavVisible(!1)):console.log("form contains errors",this.filterForm.errors)}resetFilters(){this.filterForm.setValue({features:Object.assign({},this.setItemDefaultValue),biomes:Object.assign({},this.setItemDefaultValue),rarity:Object.assign({},this.setItemDefaultValue),resources:Object.assign({},this.setItemDefaultValue),geography:Object.assign({},this.setItemDefaultValue)}),this.submitFilter()}_initFilterWithParams(){const t=this.gridUrlParams.getFilterSnapshot();Object.keys(t).forEach(o=>{this.filterForm.contains(o)&&this.filterForm.get(o).setValue(t[o])})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(m.R),e.Y36(w.G),e.Y36(i.qu),e.Y36(O.T))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-world-grid-filter"]],decls:20,vars:8,consts:[[1,"filter-group",3,"clrVerticalNavGroupExpanded"],["shape","filter","clrVerticalNavIcon",""],[1,"filter-wrapper"],[1,"clr-form","clr-form-compact",3,"formGroup"],[1,"filter-subgroup"],[3,"formControlName"],[1,"submit-btn-area"],[1,"btn","btn-sm",3,"click"],["type","submit",1,"btn","btn-sm","btn-primary",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"clr-vertical-nav-group",0),e._UZ(1,"cds-icon",1),e._uU(2," Worlds Filter "),e.TgZ(3,"clr-vertical-nav-group-children",2),e.TgZ(4,"form",3),e.TgZ(5,"div",4),e._UZ(6,"app-rarity-filter",5),e.qZA(),e.TgZ(7,"div",4),e._UZ(8,"app-features-filter",5),e.qZA(),e.TgZ(9,"div",4),e._UZ(10,"app-biomes-filter",5),e.qZA(),e.TgZ(11,"div",4),e._UZ(12,"app-resources-filter",5),e.qZA(),e.TgZ(13,"div",4),e._UZ(14,"app-geo-filter",5),e.qZA(),e.TgZ(15,"div",6),e.TgZ(16,"button",7),e.NdJ("click",function(){return o.resetFilters()}),e._uU(17," Reset "),e.qZA(),e.TgZ(18,"button",8),e.NdJ("click",function(){return o.submitFilter()}),e._uU(19," Apply Filter "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.Q6J("clrVerticalNavGroupExpanded",!0),e.xp6(1),e.uIk("badge",o.getBadge()),e.xp6(3),e.Q6J("formGroup",o.filterForm),e.xp6(2),e.Q6J("formControlName","rarity"),e.xp6(2),e.Q6J("formControlName","features"),e.xp6(2),e.Q6J("formControlName","biomes"),e.xp6(2),e.Q6J("formControlName","resources"),e.xp6(2),e.Q6J("formControlName","geography"))},directives:[a.A0B,a.nkF,a.ogR,a.d6G,i._Y,i.JL,i.sg,I,i.JJ,i.u,W,S,q.K,D.g],styles:[".filter-group[_ngcontent-%COMP%]{margin-top:1.8rem}.filter-subgroup[_ngcontent-%COMP%]{margin-top:.6rem}.filter-wrapper[_ngcontent-%COMP%]{margin:0 .1rem}.submit-btn-area[_ngcontent-%COMP%]{margin-top:.6rem;display:flex;justify-content:space-between;flex-direction:row;align-items:center;align-content:space-around}"]}),r})();const Y=[{path:"",component:F},{path:"",component:(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-worlds-filter"]],decls:1,vars:0,template:function(t,o){1&t&&e._UZ(0,"app-world-grid-filter")},directives:[j],styles:[""]}),r})(),outlet:"sidenav"}];let k=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[d.Bz.forChild(Y)],d.Bz]}),r})(),P=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[u.ez,k,f.L,a.TLv,i.u5]]}),r})()}}]);